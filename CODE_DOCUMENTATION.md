# Документация программного кода - Система управления продуктовым магазином

## Структура проекта

### Основные файлы
1. `main.py` - главный файл программы, содержащий точку входа и настройку базы данных
2. `main_window.py` - основной модуль GUI, содержащий главное окно и логику управления продуктами
3. `product_dialog.py` - модуль диалогового окна для добавления/редактирования продуктов
4. `requirements.txt` - зависимости проекта

## Описание модулей

### main.py

#### Функции:
- `get_app_dir()` - получение директории приложения
- `setup_database()` - настройка и инициализация базы данных SQLite
- `main()` - точка входа в приложение

### main_window.py

#### Класс MainWindow
Основной класс приложения, наследующий QMainWindow.

##### Основные методы:
- `__init__()` - инициализация главного окна
- `init_ui()` - настройка пользовательского интерфейса
- `db_connect()` - подключение к базе данных
- `update_table()` - обновление таблицы продуктов
- `add_product()` - добавление нового продукта
- `edit_product()` - редактирование существующего продукта  
- `delete_product()` - удаление продукта
- `search_product()` - поиск продукта
- `update_charts()` - обновление аналитических графиков

##### Аналитические методы:
- `calculate_income_trend()` - расчет тренда дохода
- `predict_future_income()` - прогнозирование дохода
- `calculate_discounts()` - расчет скидок для товаров

### product_dialog.py

#### Класс ProductDialog
Класс диалогового окна для работы с продуктами.

##### Основные методы:
- `__init__()` - инициализация диалога
- `fill_form()` - заполнение формы данными продукта
- `get_data()` - получение данных из формы
- `validate_and_accept()` - валидация данных и закрытие формы

## База данных

### Структура таблицы products:
```sql
CREATE TABLE IF NOT EXISTS products (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL,
    package TEXT,
    receipt_date TEXT,
    storage_days INTEGER,
    purchase_volume REAL,
    sales_volume REAL,
    price REAL
)
```

## Зависимости проекта

### Основные библиотеки:
- PySide6 - GUI фреймворк
- SQLite3 - база данных
- Matplotlib - визуализация данных
- Scikit-learn - машинное обучение (прогнозирование)
- NumPy - математические операции

## Архитектура приложения

### Паттерны проектирования:
1. **MVC (Model-View-Controller)**
   - Model: База данных SQLite
   - View: GUI элементы в MainWindow
   - Controller: методы обработки событий в MainWindow

2. **Observer**
   - Автоматическое обновление интерфейса при изменении данных
   - Синхронизация таблицы и графиков

### Взаимодействие компонентов

#### Поток данных
```
Database <-> MainWindow <-> Analytics
```

#### Обновление данных
```
User Input -> MainWindow -> Database -> Analytics -> GUI Update
```

## Особенности реализации

### 1. Управление данными
- Использование SQLite для локального хранения
- Валидация данных перед сохранением
- Поддержка CRUD операций

### 2. Пользовательский интерфейс  
- Адаптивный дизайн
- Темная тема
- Интерактивные элементы управления
- Валидация пользовательского ввода

### 3. Аналитика
- Визуализация данных с помощью Matplotlib
- Прогнозирование доходов с использованием Scikit-learn
- Автоматическое обновление графиков

### 4. Оптимизация производительности
- Отложенное обновление графиков
- Эффективное использование памяти
- Оптимизированные SQL-запросы

## Рекомендации по разработке

### 1. Добавление новых функций
- Следовать паттерну MVC
- Использовать существующие классы и методы
- Добавлять новые методы в соответствующие классы

### 2. Модификация базы данных
- Сохранять обратную совместимость
- Использовать миграции при необходимости
- Документировать изменения схемы

### 3. Расширение аналитики
- Добавлять новые методы в класс MainWindow
- Следовать существующим паттернам визуализации
- Оптимизировать производительность

### 4. Тестирование
- Проверять валидацию данных
- Тестировать граничные случаи
- Проверять производительность на больших наборах данных